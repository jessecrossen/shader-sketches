<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>Shader Sketches by Jesse Crossen</title>
        <script type="text/javascript" src="https://rawgit.com/patriciogonzalezvivo/glslCanvas/master/dist/GlslCanvas.js"></script>
        <style>
            body, html {
                margin: 0;
                padding: 0;
                color: #444;
            }
            canvas {
                display: block;
                margin: 12px auto;
                border-radius: 16px;
            }
            a, a:visited {
                text-decoration: none;
                font-style: italic;
                color: inherit;
            }
            header {
                display: block;
                text-align: center;
                margin: 8px auto;
            }
            footer {
                display: block;
                position: absolute;
                bottom: 0;
                right: 0;
                text-align: right;
                padding: 8px 16px;
            }
        </style>
    </head>
    <body>
        <header>
            <a href="#ripples">ripples</a> 	â€¢ 
            <a href="#bamboo">bamboo</a>
        </header>
        <canvas class="glslCanvas" width="512" height="512"></canvas>
        <footer>
            <a id="source" href="https://github.com/jessecrossen/shader-sketches/">source</a>
        </footer>
        <script>
            const canvas = document.getElementsByTagName('canvas')[0];
            const glsl = new GlslCanvas(canvas);
            const loadFragUrl = (url) => {
                if (url.indexOf('#') < 0) url = './#ripples';
                url = url.replace('#', 'shaders/') + '.frag';
                const xhr = new XMLHttpRequest();
                xhr.open('GET', url);
                xhr.onload = () => { glsl.load(xhr.responseText); };
                xhr.send();
            }
            const sourceLink = document.getElementById('source');
            const links = document.getElementsByTagName('a');
            for (const link of links) {
                link.onclick = (e) => {
                    const i = link.href.indexOf('#');
                    if (i >= 0) {
                        loadFragUrl(link.href);
                        sourceLink.href = 
                            'https://github.com/jessecrossen/shader-sketches' +
                            '/blob/master/shaders/' +
                            link.href.substr(i + 1)+'.frag';
                    }
                }
            }
            loadFragUrl(document.location.href);
        </script>
    </body>
</html>